<!DOCTYPE html>
<html lang="fr" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Page profil</title>
</head>
<body>

<p>
  <span th:text="${user.nomU}"></span>
  <span> </span>
  <span th:text="${user.prenomU}"></span>
</p>

<div th:if="${session.user != null}">
  <h3>Rechercher un ami :</h3>
  <form action="/user/rechercher" method="get">
    <input type="text" name="nom" placeholder="Nom de l'utilisateur" th:value="${param.nom}" required>
    <button type="submit">Rechercher</button>
  </form>
</div>

<br>

<table>
  <tr>
    <th>Nom</th>
    <th>Prénom</th>
    <th>Email</th>
  </tr>
  <tr>
    <td th:text="${user.nomU}"></td>
    <td th:text="${user.prenomU}"></td>
    <td th:text="${user.emailU}"></td>
  </tr>
</table>

<th:block th:if="${session.user != null and user != null and session.user == user}">
  <a th:href="@{'/user/' + ${session.user.idUti} + '/modifierProfil'}">modifier profil</a>
  <a th:href="@{'/user/' + ${session.user.idUti} + '/modifierPassword'}">modifier password</a>
</th:block>

<!-- ===== Lien vers tous les posts ===== -->
<p>
  <a th:href="@{'/post/' + ${session.user.idUti}}">voir tout mon post</a>
</p>

<!-- ===== Mes posts originaux ===== -->
<hr>
<h2>Mes posts originaux</h2>
<div>
  <div th:each="post : ${posts}">
    <table>
      <thead>
      <tr>
        <th colspan="2" th:text="${user.prenomU + ' ' + user.nomU}"></th>
      </tr>
      </thead>
      <tbody>
      <tr>
        <td th:text="'date : '"></td>
        <td th:text="${@dateUtil.formatTimestamp(post.datePost)}"></td>
      </tr>
      <tr>
        <td colspan="2">
          <a th:href="@{/post(id=${post.idPost})}" th:text="${post.titrePost}"></a>
        </td>
      </tr>
      <tr>
        <td colspan="2" th:text="${post.textePost}"></td>
      </tr>
      <tr th:if="${post.createur.idUti != session.user.idUti}">
        <td colspan="2">
          <a th:href="@{/post/repost(id=${post.idPost})}">Reposter</a>
        </td>
      </tr>
      </tbody>
    </table>
  </div>
</div>

<!-- ===== Reposts ===== -->
<hr>
<h2>Posts que j'ai repostés</h2>
<div>
  <div th:each="post : ${user.postsRepostes}">
    <table>
      <thead>
      <tr>
        <th colspan="2" th:text="${post.createur.prenomU + ' ' + post.createur.nomU} + ' (original)'"></th>
      </tr>
      </thead>
      <tbody>
      <tr>
        <td th:text="'date : '"></td>
        <td th:text="${@dateUtil.formatTimestamp(post.datePost)}"></td>
      </tr>
      <tr>
        <td colspan="2">
          <a th:href="@{/post(id=${post.idPost})}" th:text="${post.titrePost}"></a>
        </td>
      </tr>
      <tr>
        <td colspan="2" th:text="${post.textePost}"></td>
      </tr>
      </tbody>
    </table>
  </div>
</div>

<hr>

<div th:if="${session.user != null and user != null and session.user == user}">
  <a href="/post/creer">Créer un post</a>
  <a href="/demande/demandes-recues">voir mes demandes d'amis</a>
  <a href="/user/mes-amis">voir mes amis</a>
  <a th:href="@{/user/mes-groupes}">voir mes groupes</a>

</div>

</body>
</html>
